\section*{Chapter 7 - Estimating the CDF and Statistical Functionals}

\subsection*{Solution 1}

Let $X_1, X_2, ..., X_n$ random variables with cumulative distribution function $F$.
Let $\hat{F}_n(x) = \frac{1}{n} \sum I(X_i \leq x)$ be the emperical distribution function of $F$.
\begin{itemize}
    \item[(a)] Note that
        \begin{equation*}
            E(I(X_i \leq x)) = \int_{-\infty}^{\infty} I(t \leq x) f(t) dt
                = \int_{-\infty}^{x} f(t) dt
                = F(x).
        \end{equation*}
        Therefore, $E(\hat{F}_n(x)) = \frac{1}{n} \sum E(I(X_i \leq x)) = F(x)$.
    \item[(b)] As in (a), we calculate $E(I(X_i \leq x)^2) = F(x)$.
        So
        \begin{equation*}
            V(\hat{F}_n(x)) = \frac{1}{n^2} \sum_{i = 1}^n V(I(X_i \leq x))
                = \frac{1}{n^2} \sum_{i = 1}^n (E(I(X_i \leq x)^2) - E(I(X_i \leq x))^2)
                = \frac{1}{n} F(x) (1 - F(x)).
        \end{equation*}
    \item[(c)] Using (a) we have $\mathrm{bias} = E(\hat{F}_n(x)) - F(x) = 0$, so from (b), $\mathrm{MSE} = V(\hat{F}_n(x)) = \frac{1}{n} F(x) (1 - F(x)) \to 0$ when $n \to \infty$.
    \item[(d)] As $\mathrm{MSE} = E((\hat{F}_n(x) - F(x))^2) \to 0$ as $n \to \infty$, $\hat{F}_n(x) \xrightarrow{qm} F(x)$ and by Theorem 5.4.a $\hat{F}_n(x) \xrightarrow{P} F(x)$.
\end{itemize}


\subsection*{Solution 2}

Let $X_1, X_2, ..., X_n \sim \mathrm{Bernoulli}(p)$ and $Y_1, Y_2, ..., Y_m \sim \mathrm{Bernoulli}(q)$.

\begin{itemize}
    \item[(a)] The plug-in estimator for $p$ is $\hat{p} = E(\overline{X}_n) = \frac{1}{n} \sum_{i = 1}^n X_i$.
        The plug-in estimator for the standard error on $\hat{p}$ is $\sqrt{\frac{1}{n} \hat{p}(1 - \hat{p})}$.
    \item[(b)] The 90\% confidence interval for plug-in estimator $\hat{p}$ is $\hat{p} \pm z_{0.05} \sqrt{\frac{1}{n} \hat{p}(1 - \hat{p})}$.
    \item[(c)] The plug-in estimator for $p - q$ is $\hat{p} - \hat{q}$.
        The plug-in estimator for the standard error on $\hat{p} - \hat{q}$ is $\sqrt{V(\hat{p}) + V(\hat{q})} = \sqrt{\frac{1}{n} \hat{p}(1 - \hat{p}) + \frac{1}{m} \hat{q}(1 - \hat{1})}$.
    \item[(d)] The 90\% confidence interval for plug-in estimator $\hat{p} - \hat{q}$ is $\hat{p} - \hat{q} \pm z_{0.05} \sqrt{\frac{1}{n} \hat{p}(1 - \hat{p}) + \frac{1}{m} \hat{q}(1 - \hat{q})}$.
\end{itemize}


\subsection*{Solution 3}

See code.


\subsection*{Solution 4}

Let $X_1, X_2, ..., X_n \sim F$.
Let $\hat{F}(x) = \frac{1}{n} \sum I(X_i \leq x)$.
Denote $Y_i = I(X_i \leq x)$.
Note that $\overline{Y}_n = \hat{F}(x)$, and $E(\hat{F}(x)) = F(x)$ and $V(\hat{F}(x)) = \frac{1}{n} F(x)(1 - F(x))$.
By the central limit theorem
\begin{equation*}
    \mathrm{Normal}(0, 1) \approx \frac{\overline{Y}_n - E(\overline{Y}_n)}{\sqrt{V(\overline{Y}_n)}}
        = \sqrt{n} \frac{\hat{F}(x) - F(x)}{\sqrt{F(x)(1 - F(x))}}.
\end{equation*}
In other words, when $n \to \infty$, $\hat{F}(x)$ behaves as a random variable from the distribution $\mathrm{Normal}(F(x), \frac{1}{n} F(x)(1 - F(x)))$.
