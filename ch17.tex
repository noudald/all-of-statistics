\section*{Chapter 17 - Directed Graphs and Conditional Independence}

\subsection*{Solution 17.1}

If $f(x,y|z) = f(x|z)f(y|z)$, then $f(x|y,z) = \frac{f(x,y|z)}{f(y|z)} = f(x|z)$.
In the opposite direction, if $f(x|y,z) = f(x|z)$, then $f(x,y|z) = f(x|y,z)f(y|z) = f(x|z)f(y|z)$.


\subsection*{Solution 17.2}

\begin{itemize}
    \item[(a)] Let $X \bot Y | Z$, then $f_{Y,X|Z}(y,x|z) = f_{X,Y|Z}(x,y|z) = f(x|z)f(y|z) = f(y|z)f(x|z)$, so $Y \bot X | Z$.
    \item[(b)] Let $X \bot Y | Z$, $h: \mathbb{R} \to \mathbb{R}$, and $U = h(X)$.
        Define $A_{h,x} = \{x' | h(x') \leq x\}$.
        We have
        \begin{equation*}
            f(h(x)|y,z) = \left(\int_{A_{h,x}} f(x|y,z) dx \right)'
                = \left(\int_{A_{h,x}} f(x|z) dx \right)'
                = f(h(x)|z).
        \end{equation*}
        So, $U \bot Y | Z$.
    \item[(c)] Let $X \bot Y | Z$, $U = h(X)$.
        Note from (b) that $Y \bot Y | Z$, so $f(h(x)|y, z) = f(h(x)|z)$.
        We have
        \begin{equation*}
            f(x|y,z,h(x)) = \frac{f(x,h(x)|y,z)}{f(h(x)|y,z)}
                = \frac{f(x,h(x)|z)}{f(h(x)|z)}
                = f(x|z,h(x)).
        \end{equation*}
        So, $X \bot Y | (Z, U)$.
    \item[(d)] Let $X \bot Y | Z$ and $X \bot W | (Y, Z)$.
        We have
        \begin{equation*}
            f(w,y|x,z) = f(w|x,y,z) f(y|x,z)
                = f(w|y,z) f(y|z)
                = f(w,y|z).
        \end{equation*}
    \item[(e)] Let $X \bot Y | Z$ and $X \bot Z | Y$.
        Note that $f(x|y,z) = f(x|z)$ and $f(x|y,z) = f(x|y)$, so $f(x|z) = f(x|y)$.
        We have
        \begin{equation*}
            f(x) = \int f(x|z)f(z)dz
                = \int f(x|y)f(z)dz
                = f(x|y) \int f(z)dz
                = f(x|y)
                = f(x|y, z).
        \end{equation*}
        So $X \bot (Y, Z)$.
\end{itemize}


\subsection*{Solution 17.3}

\begin{itemize}
    \item[(a)]
        We have
        \begin{table}[H]
            \begin{tabular}{l|l||c|c}
                X & Y & $P(X,Y|Z=0)$ & $P(X,Y|Z=1)$ \\ \hline \hline
                0 & 0 & 0.81         & 0.25         \\ \hline
                0 & 1 & 0.09         & 0.25         \\ \hline
                1 & 0 & 0.09         & 0.25         \\ \hline
                1 & 1 & 0.01         & 0.25
            \end{tabular}
        \end{table}
    \item[(b)] We just have to check that $P(X,Y|Z) = P(X|Z)P(Y|Z)$, so
        \begin{table}[H]
            \begin{tabular}{c|c|c||c|c|c|c}
                $X$ & $Y$ & $Z$ & $P(X|Z)$ & $P(Y|Z)$ & $P(X|Z)P(Y|Z)$ & $P(X,Y|Z)$ \\ \hline \hline
                0   & 0   & 0   & 0.9      & 0.9      & 0.81           & 0.81       \\ \hline
                1   & 0   & 0   & 0.1      & 0.9      & 0.09           & 0.09       \\ \hline
                0   & 1   & 0   & 0.9      & 0.1      & 0.09           & 0.09       \\ \hline
                1   & 1   & 0   & 0.1      & 0.1      & 0.01           & 0.01       \\ \hline
                0   & 0   & 1   & 0.5      & 0.5      & 0.25           & 0.25       \\ \hline
                1   & 0   & 1   & 0.5      & 0.5      & 0.25           & 0.25       \\ \hline
                0   & 1   & 1   & 0.5      & 0.5      & 0.25           & 0.25       \\ \hline
                1   & 1   & 1   & 0.5      & 0.5      & 0.25           & 0.25
            \end{tabular}
        \end{table}
        So $P(X,Y|Z) = P(X|Z)P(Y|Z)$.
    \item[(c)] The marginal distributions of $X$ and $Y$ are $P(X = 0) = 0.7$, $P(X = 1) = 0.3)$, and $P(Y = 0) = 0.7$ and $P(Y = 1) = 0.3$.
    \item[(d)] Take $X = 0$ and $Y = 0$, then $P(X=0)P(Y=0) = 0.49$, but $P(X=0,Y=0) = 0.53)$.
        So $P(X, Y) \neq P(X)P(Y)$.
\end{itemize}


\subsection*{Solution 17.4}

Apply Theorem 17.6.


\subsection*{Solution 17.5}

Using Theorem 17.6, $X \bot \tilde{X} | \pi_X = X \bot Z$.

To show that $X$ and $Z$ are dependent of $Y$, we only have to find one example of $f$ satisfying $X \rightarrow Y \leftarrow Z$ such that not $X \bot Z | Y$.
Let $P(X = 0) = \frac{1}{2} = P(X = 1)$ and $P(Z = 0) = \frac{1}{2} = P(Z = 1)$.
Define $Y$ by $Y = 1$ if $X = 1$ and $Z = 1$, otherwise $Y = 0$.
Note that for this case we have $f(x, y, z) = f(x) f(y|x,z) f(z)$, because
\begin{table}[H]
    \begin{tabular}{c|c|c||c|c|c|c|c|c}
        $X$ & $Y$ & $Z$ & $P(X)$ & $P(Y)$ &  $P(Z)$ & $P(Y|X,Z)$ & $P(X)P(Y|X,Z)P(Z)$ & $P(X,Y,Z)$ \\ \hline \hline
        0   & 0   & 0   & 0.5    & 0.75   &  0.5    & 1          & 0.25               & 0.25       \\ \hline
        1   & 0   & 0   & 0.5    & 0.75   &  0.5    & 1          & 0.25               & 0.25       \\ \hline
        0   & 1   & 0   & 0.5    & 0.25   &  0.5    & 0          & 0                  & 0          \\ \hline
        1   & 1   & 0   & 0.5    & 0.25   &  0.5    & 0          & 0                  & 0          \\ \hline
        0   & 0   & 1   & 0.5    & 0.75   &  0.5    & 1          & 0.25               & 0.25       \\ \hline
        1   & 0   & 1   & 0.5    & 0.75   &  0.5    & 0          & 0                  & 0          \\ \hline
        0   & 1   & 1   & 0.5    & 0.25   &  0.5    & 0          & 0                  & 0          \\ \hline
        1   & 1   & 1   & 0.5    & 0.25   &  0.5    & 1          & 0.25               & 0.25
    \end{tabular}
\end{table}
Note that $f_{X,Z|Y}(1, 1| 1) = 1$, but $f_{X|Y}(1|1) = \frac{1}{2} = f_{Z|Y}(1|1)$, so $f_{X,Z|Y}(1,1|1) \neq f_{X|Y}(1|1)f_{Z|Y}(1|1)$.


\subsection*{Solution 17.6}

See code.
