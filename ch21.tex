\section*{Chapter 21 - Smoothing Using Orthogonal Functions}

\subsection*{Solution 21.1}

From Lemma 20.1 we know that
\begin{equation*}
    R(J) = R(f, \hat{f}_J)
        = \int b^2(x) dx + \int V(x) dx.
\end{equation*}
As $b(x) = E(\hat{f}(x)) - f(x) = - \sum_{j = J + 1}^{\infty} \beta_j \phi_j(x)$, we have
\begin{equation*}
    \int b^2(x) dx = \int \sum_{i, j = J}^{\infty} \beta_i \beta_j \phi_i(x) \phi_j(x) dx
        = \sum_{j = J + 1}^{\infty} \beta_j^2.
\end{equation*}
For the second part
\begin{equation*}
    \begin{split}
        \int V(x) dx &= \int E((\hat{f}_J(x) - E(\hat{f}_J(x)))^2) dx \\
            &= \int E(\hat{f}(x)^2) - 2E(\hat{f}(x)E(\hat{f}(x))) + E(\hat{f}(x))^2 dx \\
            &= \sum_{j = 1}^J E(\hat{b}_j^2) - 2\sum_{j = 1}^J \beta_j^2 + \sum_{j = 1}^J \beta_j^2 \\
            &= \sum_{j = 1}^J \frac{\sigma_j^2}{n},
    \end{split}
\end{equation*}
as $E(\hat{\beta}_j^2) = V(\hat{\beta}_j) + E(\hat{\beta}_j)^2 = \frac{\sigma_j^2}{n} + \beta_j^2$.
Combining all above yields the result.


\subsection*{Solution 21.2}

Note that
\begin{equation*}
    E(\hat{\beta}_j^2) = V(\hat{\beta}_j) + E(\hat{\beta}_j)^2 = \frac{\sigma^2}{n} + \beta_j^2.
\end{equation*}
Therefore,
\begin{equation*}
    \begin{split}
        R(r, \hat{r}) &= E\left(\int (r(x) - \hat{r}(x))^2 dx\right) \\
            &= E\left(\int r^2(x) - 2r(x)\hat{r}(x) + \hat{r}^2(x) dx\right) \\
            &= E\left(\int \sum_{i, j = 1}^{\infty} \beta_i \beta_j \phi_i(x) \phi_j(x) - 2 \sum_{i = 1}^{\infty} \sum_{j = 1}^J \beta_i \hat{\beta}_j \phi_i(x) \phi_j(x) + \sum_{i, j = 1}^J \hat{\beta}_i \hat{\beta}_j \phi_i(x) \phi_j(x) dx\right) \\
            &= \sum_{j = 1}^{\infty} \beta_j^2 - 2\sum_{j = 1}^J \beta_j^2 + \sum_{j = 1}^J E(\hat{beta}^2) \\
            &= \sum_{j = 1}^{\infty} \beta_j^2 - 2\sum_{j = 1}^J \beta_j^2 + \sum_{j = 1}^J (\frac{\sigma^2}{n} + \beta_j^2) \\
            &= \sum_{j = J + 1}^{\infty} \beta_j^2 + J \frac{\sigma^2}{n}.
    \end{split}
\end{equation*}


\subsection*{Solution 21.3}

Straightforward calculation.


\subsection*{Solution 21.4}

Parseval's lemma.
We have
\begin{equation*}
    ||f||^2 = \int f^2(x) dx
        = \int \sum_{i, j = 1}^{\infty} \beta_i \beta_j \phi_i(x) \phi_j(x) dx
        = \sum_{j = 1}^{\infty} \beta_j^2
        = ||\beta||^2.
\end{equation*}


\subsection*{Solution 21.5}

See code.


\subsection*{Solution 21.6}

A tedious exercise.
I only give the solutions.
\begin{enumerate}
    \item[(a)] $f(x) = \sqrt{2} \cos(3 \pi x)$.
    \item[(b)] $a_j = (\pi (1 - j^2))^{-1}$ if $j$ is even, zero otherwise.
\end{enumerate}
The rest of the exercise is in the code.


\subsection*{Solution 21.7}

See code.
